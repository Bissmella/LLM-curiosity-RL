lamorel_args:
  log_level: info
  allow_subgraph_use_whith_gradient: false
  distributed_setup_args:
    n_rl_processes: 1
    n_llm_processes: 2
  accelerate_args:
    config_file: ../configs/accelerate/default_config.yaml
    machine_rank: 0
    main_process_ip: 127.0.0.1
    main_process_port: 12342
    num_machines: 1
  llm_args:
    model_type: causal
    model_path: t5-small
    use_vllm: True
    chat: false
    vlm_model_type: causal
    #vlm_model_path: microsoft/Florence-2-base-ft
    pretrained: true
    minibatch_size: 192
    pre_encode_inputs: True
    load_in_4bit: true
    parallelism:
      use_gpu: true
      model_parallelism_size: 1
      synchronize_gpus_after_scoring: false
      empty_cuda_cache_after_scoring: true
  config_alfred: null
rl_script_args:
  path: null
  seed: 1
  train_eval: "valid_train"  #valid_train  or train
  # ppo
  ppo_epochs: 4
  lam: 0.99
  gamma: 0.99
  lr: 1e-4
  entropy_coef: 0.01
  value_loss_coef: 0.5
  clip_eps: 0.2
  max_grad_norm: 0.5
  minibatch_size: 250
  use_all_params_for_optim: false
  quantized_optimizer: false
  # BC
  path_data: null
  # llm
  use_lora: true
  gradient_batch_size: 1
  gradient_minibatch_size:
  ## LoRA
  lora_r: 32
  lora_alpha: 16
  lora_target_modules:   ["q", "v", "k", "wi", "wo", "lm_head"]
  # rl training
  number_envs: 1
  number_eval_envs: 20
  max_ep_len: 200
  epochs: 200
  startepochs: 0
  prompt_id: 0
  prompt_element: ['past action','obs']
  steps_per_epoch: 400
  save_freq: 1
  output_dir: null
  loading_path:  #"/home/bahaduri/VIPER/weights/Mistral/pick"
  vlm_loading_path: #/lustre/fswork/projects/rech/lrp/ufn64rt/project/vlm
  transitions_buffer_len: 2
  # environment
  name_environment: 'AlfredTWEnv' # 'AlfredTWEnv', 'AlfredThorEnv'
  task: [1]
  ## BabyAI-specific
  action_space: ["turn_left","turn_right","go_forward","pick_up","drop","toggle"]
  ## TWC-specific
  twc_levels:
  config_file:
  train_mode: true
  ## reward
  intrinsic_reward: False
  intrinsic_decay: False
  temp_pred: False
  ## value
  dual_val: False
wandb_args:
    run: "PPO"
    mode: "offline"
    project: "BC"
eval_configs:
    use_vlm: False
    log_path: ""
    json_file_path: ""
    results_file: ""
    task_name: ""
    zeroshot: False